<!-- src/app/home/blog/blog-create/blog-create.component.html -->
<div class="blog-create-container">
  <!-- é é¢æ¨™é¡Œ -->
  <div class="page-header">
    <h1>{{pageTitle}}</h1>
    <p>ç·¨è¼¯æ‚¨çš„éƒ¨è½æ ¼æ–‡ç« </p>
  </div>

  <!-- å»ºç«‹è¡¨å–® -->
  <div class="form-section">
    <form [formGroup]="createForm" (ngSubmit)="onSubmit()" class="blog-form">

      <!-- æ¨™é¡Œè¼¸å…¥ -->
      <div class="form-group">
        <label for="title" class="form-label required">æ–‡ç« æ¨™é¡Œ</label>
        <input type="text" id="title" formControlName="title" placeholder="è«‹è¼¸å…¥æ–‡ç« æ¨™é¡Œ" class="form-control"
          [class.error]="isFieldInvalid('title')" maxlength="200">
        <div class="field-info">
          <span class="char-count">
            {{ createForm.get('title')?.value?.length || 0 }}/200
          </span>
        </div>

        <div *ngIf="isFieldInvalid('title')" class="error-message">
          {{ getFieldError('title') }}
        </div>
      </div>

      <!-- å…§å®¹è¼¸å…¥ -->
      <div class="form-group">
        <label for="content" class="form-label required">æ–‡ç« å…§å®¹</label>
        <textarea id="content" formControlName="content" placeholder="è«‹è¼¸å…¥æ–‡ç« å…§å®¹..." class="form-control content-textarea"
          [class.error]="isFieldInvalid('content')" rows="15"></textarea>

        <div class="field-info">
          <span class="char-count">
            {{ createForm.get('content')?.value?.length || 0 }} å­—ç¬¦
          </span>
        </div>

        <div *ngIf="isFieldInvalid('content')" class="error-message">
          {{ getFieldError('content') }}
        </div>
      </div>

      <!-- æ¨™ç±¤è¼¸å…¥ -->
      <div class="form-group">
        <label for="tags" class="form-label">æ¨™ç±¤</label>

        <!-- æ¨™ç±¤è¼¸å…¥æ¡† -->
        <div class="tag-input-section">
          <input type="text" id="tagInput" [(ngModel)]="tagInput" [ngModelOptions]="{standalone: true}"
            placeholder="è¼¸å…¥æ¨™ç±¤å¾ŒæŒ‰ Enter æˆ–é»æ“Šæ–°å¢" class="form-control tag-input" maxlength="20"
            (keypress)="onTagKeyPress($event)">

          <button type="button" class="btn btn-secondary add-tag-btn" (click)="addTag()" [disabled]="!tagInput.trim()">
            æ–°å¢
          </button>
        </div>

        <!-- å·²æ–°å¢çš„æ¨™ç±¤ -->
        <div class="tags-display" *ngIf="tags.length > 0">
          <span *ngFor="let tag of tags; let i = index" class="tag-item">
            {{ tag }}
            <button type="button" class="tag-remove-btn" (click)="removeTag(i)" title="ç§»é™¤æ¨™ç±¤">
              Ã—
            </button>
          </span>
        </div>

        <div class="field-info">
          <span class="tag-count">{{ tags.length }}/10 å€‹æ¨™ç±¤</span>
        </div>
      </div>

      <!-- ç™¼å¸ƒç‹€æ…‹ -->
      <div class="form-group">
        <label for="status" class="form-label required">ç™¼å¸ƒç‹€æ…‹</label>
        <select id="status" formControlName="status" class="form-control" [class.error]="isFieldInvalid('status')">
          <option *ngFor="let option of statusOptions" [value]="option.value">
            {{ option.label }}
          </option>
        </select>

        <div class="field-help">
          <small *ngIf="createForm.get('status')?.value === 'DRAFT'" class="status-help draft">
            ğŸ“ è‰ç¨¿ï¼šæ–‡ç« å°‡å„²å­˜ä½†ä¸æœƒå…¬é–‹é¡¯ç¤º
          </small>
          <small *ngIf="createForm.get('status')?.value === 'PUBLISHED'" class="status-help published">
            ğŸŒ ç™¼å¸ƒï¼šæ–‡ç« å°‡ç«‹å³å…¬é–‹ï¼Œæ‰€æœ‰äººéƒ½å¯ä»¥çœ‹åˆ°
          </small>
        </div>

        <div *ngIf="isFieldInvalid('status')" class="error-message">
          {{ getFieldError('status') }}
        </div>
      </div>

      <!-- æŒ‰éˆ•å€åŸŸ -->
      <div class="form-actions">
        <div class="action-left">
          <button type="button" class="btn btn-secondary" (click)="goBack()" [disabled]="isSubmitting">
            â† è¿”å›åˆ—è¡¨
          </button>
        </div>

        <div class="action-right">
          <button type="button" class="btn btn-secondary" (click)="onReset()" [disabled]="isSubmitting">
            ğŸ—‘ï¸ æ¸…é™¤
          </button>

          <button type="button" class="btn btn-primary" (click)="publish()"
            [disabled]="isSubmitting || createForm.invalid">
            <span *ngIf="isSubmitting && createForm.get('status')?.value === 'PUBLISHED'"
              class="loading-spinner"></span>
            ğŸš€ ç™¼å¸ƒæ–‡ç« 
          </button>
        </div>
      </div>

      <!-- è¡¨å–®ç‹€æ…‹æç¤º -->
      <div class="form-status" *ngIf="isSubmitting">
        <div class="submitting-message">
          <span class="loading-spinner"></span>
          <span *ngIf="createForm.get('status')?.value === 'DRAFT'">æ­£åœ¨å„²å­˜è‰ç¨¿...</span>
          <span *ngIf="createForm.get('status')?.value === 'PUBLISHED'">æ­£åœ¨ç™¼å¸ƒæ–‡ç« ...</span>
        </div>
      </div>
    </form>
  </div>
</div>