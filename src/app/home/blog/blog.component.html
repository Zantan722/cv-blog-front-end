<div class="blog-query-container">
  <!-- é é¢æ¨™é¡Œ -->
  <div class="page-header">
    <h1>{{pageTile}}</h1>
    <p>æœå°‹éƒ¨è½æ ¼æ–‡ç« </p>
  </div>

  <!-- æœå°‹è¡¨å–® -->
  <div class="search-section">
    <form [formGroup]="searchForm" (ngSubmit)="onSearch()" class="search-form">
      <div class="form-row">
        <!-- ID æœå°‹ -->
        <div class="form-group">
          <label for="id">æ–‡ç«  ID</label>
          <input type="number" id="id" formControlName="id" placeholder="è«‹è¼¸å…¥æ–‡ç«  ID" class="form-control">
        </div>

        <!-- æ¨™é¡Œæœå°‹ -->
        <div class="form-group">
          <label for="title">æ–‡ç« æ¨™é¡Œ</label>
          <input type="text" id="title" formControlName="title" placeholder="è«‹è¼¸å…¥æ¨™é¡Œé—œéµå­—" class="form-control">
        </div>

        <!-- å»ºç«‹è€…æœå°‹ -->
        <div *ngIf="!isUserSearchPage || isAdmin()" class="form-group">
          <label for="author">å»ºç«‹è€…</label>
          <input type="text" id="author" formControlName="author" placeholder="è«‹è¼¸å…¥å»ºç«‹è€…å§“å" class="form-control">
        </div>
      </div>

      <div class="form-row">
        <!-- é–‹å§‹æ—¥æœŸ -->
        <div class="form-group">
          <label for="startDate">é–‹å§‹æ—¥æœŸ</label>
          <input type="date" id="startDate" formControlName="startDate" class="form-control">
        </div>

        <!-- çµæŸæ—¥æœŸ -->
        <div class="form-group">
          <label for="endDate">çµæŸæ—¥æœŸ</label>
          <input type="date" id="endDate" formControlName="endDate" class="form-control">
        </div>

        <!-- æŒ‰éˆ•çµ„ -->
        <div class="form-group button-group">
          <button type="submit" class="btn btn-primary" [disabled]="isLoading">
            <span *ngIf="isLoading" class="loading-spinner"></span>
            {{ isLoading ? 'æœå°‹ä¸­...' : 'æœå°‹' }}
          </button>

          <button type="button" class="btn btn-secondary" (click)="onReset()" [disabled]="isLoading">
            é‡ç½®
          </button>

          <button type="button" class="btn btn-outline" (click)="onClear()" [disabled]="isLoading">
            æ¸…é™¤
          </button>


        </div>
      </div>
    </form>
  </div>

  <!-- æœå°‹çµæœçµ±è¨ˆ -->
  <div class="result-summary">
    <div>
      <button *ngIf="isLoggedIn" type="button" class="btn btn-create-article" (click)="goToCreate()"
        [disabled]="isLoading">
        å»ºç«‹æ–°æ–‡ç« 
      </button>
    </div>
    <div class="summary-info">
      <span class="result-count">
        å…±æ‰¾åˆ° <strong>{{ totalItems }}</strong> ç­†è³‡æ–™
      </span>
      <span *ngIf="hasSearchCriteria()" class="search-info">
        (å·²å¥—ç”¨æœå°‹æ¢ä»¶)
      </span>
      <span class="display-range">
        é¡¯ç¤ºç¬¬ {{ getDisplayRange() }} ç­†ï¼Œå…± {{ totalItems }} ç­†
      </span>
    </div>

    <!-- æ¯é ç­†æ•¸é¸æ“‡ -->
    <div class="page-size-selector">
      <label for="pageSize">æ¯é é¡¯ç¤ºï¼š</label>
      <select id="pageSize" [value]="pageSize" (change)="onPageSizeChange($event)" class="page-size-select">
        <option *ngFor="let size of pageSizeOptions" [value]="size">
          {{ size }} ç­†
        </option>
      </select>
    </div>
  </div>

  <!-- çµæœè¡¨æ ¼ -->
  <div class="table-section">
    <div class="table-container">
      <table class="blog-table">
        <thead>
          <tr>
            <th class="col-id">ID</th>
            <th class="col-title">Title</th>
            <th class="col-creator">å»ºç«‹è€…</th>
            <th class="col-time">å»ºç«‹æ™‚é–“</th>
            <th *ngIf="isLoggedIn && (isUserSearchPage || isAdmin())" class="col-actions">ç™¼å¸ƒç‹€æ…‹</th>
            <th *ngIf="isLoggedIn && (isUserSearchPage || isAdmin())" class="col-actions">æ“ä½œ</th>
          </tr>
        </thead>
        <tbody>
          <!-- è¼‰å…¥ä¸­ç‹€æ…‹ -->
          <tr *ngIf="isLoading" class="loading-row">
            <td colspan="5" class="text-center">
              <div class="loading-content">
                <span class="loading-spinner"></span>
                æœå°‹ä¸­ï¼Œè«‹ç¨å€™...
              </div>
            </td>
          </tr>

          <!-- ç„¡è³‡æ–™ç‹€æ…‹ -->
          <tr *ngIf="!isLoading && paginatedBlogs.length === 0" class="no-data-row">
            <td colspan="5" class="text-center">
              <div class="no-data-content">
                <p>ğŸ“ æ²’æœ‰æ‰¾åˆ°ç¬¦åˆæ¢ä»¶çš„æ–‡ç« </p>
                <button class="btn btn-link" (click)="onClear()">æ¸…é™¤æœå°‹æ¢ä»¶</button>
              </div>
            </td>
          </tr>

          <!-- è³‡æ–™åˆ— -->
          <tr *ngFor="let blog of paginatedBlogs; trackBy: trackByBlogId" class="data-row"
            [class.deleted-row]="blog.deleted" (click)="goToDetail(blog.id)">
            <td class="col-id">{{ blog.id }}</td>
            <td class="col-title">
              <div class="title-content">
                <span class="title-text" [class.deleted-text]="blog.deleted">{{ blog.title }}</span>
              </div>
            </td>
            <td class="col-creator">
              <span class="creator-name" [class.deleted-text]="blog.deleted">{{ blog.author }}</span>
            </td>
            <td class="col-time">
              <span class="time-text" [class.deleted-text]="blog.deleted">{{ formatDateTime(blog.createDate) }}</span>
            </td>
            <td *ngIf="isLoggedIn && (isUserSearchPage || isAdmin())" class="col-creator">
              <span class="creator-name" [class.deleted-text]="blog.deleted">{{ getStatusDisplayName(blog.status)
                }}</span>
            </td>
            <td *ngIf="isLoggedIn && (isUserSearchPage || isAdmin()) && !blog.deleted" class="col-actions">
              <div class="action-buttons">
                <button class="btn-action btn-edit" title="ç·¨è¼¯" (click)="goToEdit(blog.id)">
                  âœï¸
                </button>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- åˆ†é æ§åˆ¶ -->
  <div class="pagination-section" *ngIf="!isLoading && totalItems > 0">
    <div class="pagination-info">
      <span>ç¬¬ {{ currentPage }} é ï¼Œå…± {{ totalPages }} é </span>
    </div>

    <div class="pagination-controls">
      <!-- ç¬¬ä¸€é æŒ‰éˆ• -->
      <button class="pagination-btn" [class.disabled]="currentPage === 1" (click)="goToPage(1)"
        [disabled]="currentPage === 1" title="ç¬¬ä¸€é ">
        âŸª
      </button>

      <!-- ä¸Šä¸€é æŒ‰éˆ• -->
      <button class="pagination-btn" [class.disabled]="currentPage === 1" (click)="previousPage()"
        [disabled]="currentPage === 1" title="ä¸Šä¸€é ">
        âŸ¨
      </button>

      <!-- é ç¢¼æŒ‰éˆ• -->
      <div class="page-numbers">
        <button *ngFor="let page of getPageNumbers()" class="pagination-btn page-number"
          [class.active]="page === currentPage" (click)="goToPage(page)">
          {{ page }}
        </button>
      </div>

      <!-- ä¸‹ä¸€é æŒ‰éˆ• -->
      <button class="pagination-btn" [class.disabled]="currentPage === totalPages" (click)="nextPage()"
        [disabled]="currentPage === totalPages" title="ä¸‹ä¸€é ">
        âŸ©
      </button>

      <!-- æœ€å¾Œä¸€é æŒ‰éˆ• -->
      <button class="pagination-btn" [class.disabled]="currentPage === totalPages" (click)="goToPage(totalPages)"
        [disabled]="currentPage === totalPages" title="æœ€å¾Œä¸€é ">
        âŸ«
      </button>
    </div>

    <!-- è·³é è¼¸å…¥æ¡† -->
    <div class="page-jump">
      <span>è·³è‡³ç¬¬</span>
      <input type="number" min="1" [max]="totalPages" #pageInput class="page-input"
        (keyup.enter)="goToPage(+pageInput.value); pageInput.value = ''" placeholder="é ">
      <button class="btn-jump" (click)="goToPage(+pageInput.value); pageInput.value = ''" [disabled]="!pageInput.value">
        è·³é 
      </button>
    </div>
  </div>
</div>